# 析构函数 

## what is destructor 

析构函数负责释放对象使用的资源，并销毁对象的非static 成员。它与构造函数功能相反。

## 析构函数做什么工作

在一个析构函数中，首先执行函数体，然后销毁成员。成员按初始化的顺序逆序销毁。 

## 什么是时候会调用析构 

1. 变量在离开其作用域时
2. 当一个对象被销毁时，其成员也被销毁 
3. 容器被销毁时，其元素也被销毁 
4. 对于动态分配的对象，当对指向它的指针应用`delete` 运算符时被销毁。

```c++
{//作用域
    Sales_data *p = new Sales_data;
    auto p2 = make_shared<Sales_data>();
    Sales_data item(*p);
    vector<Sales_data> vec;
    vec.push_back(*p2);
    delete p;  //对 p指向的对象，执行析构函数 
}
//退出作用域：释放item, p2, vec对象
//释放p2, 会递减引用计数，当引用计数变为0时，释放指针指向的内存
//释放vec，会销毁它的元素 
```

## 合成析构函数 

当一个类未定义自己的析构函数时，编译器会为它定义一个合成的析构函数。

```c++
class Sales_data {
public:
    ~Sales_data() {} 
}
```
上面的代码片段等价于 `Sales_data`的合成析构函数 

**NOTE**<br/>
析构函数体本身并不直接销毁成员。成员是在析构函数之后的隐含的阶段中被销毁的。 析构函数体是作为成员销毁步骤之外的另一部分而进行的。 



